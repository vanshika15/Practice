As we move to the login page, after entering our login id and password and hitting the a button, we land on getLoginDetails() method present in DesktopLoginNew class. 


* isValidateInputData checks if email/password field is set or not and if isLoginByEmail is specified correctly or not and depending upon that, throws Failure response.

* $input contains username/email, password entered and isLoginByEmail field.

* Initially $input['g-recaptcha-response'] is empty and $captchaResponse is set to true.

* If $captchaResponse is false then Failure Response is generated.
  Else if it is true then following flow is followed:

* - LoginUser() is called (It returns the response that contains the deails of the user such as email, username, userId, LoginType).
  - This function calls getUserDetails() (It returns the formatted response if response is returned from underlying layers or log an Exception  if  response is empty).
  - getUserDetails() function calls AuthenticateUser() and depending upon the username entered  is email or username, AuthenticateUsingEmail() or AunthenticateUsingUsername() is called that depends on third parties for aunthenticating the user and returning the response. If the response is not empty, then formatted response is returned to LoginUser().
  - After getting the response from getUserDetails(), $count for failed login attempts for that user is reinitialised to 0 and captchaEntry for 
    that particular user is deleted by LoginUser().
  - Then the successful response is returned by LoginUser().

* In case of any kind of exception such as RecaptchaException, PasswordMismatchException, ServiceException or LoginException, Failure Response is generated by the third party.
Also in case of PasswordMismatchException, $count for failed login is updated and at any point $count exceeds 3, captchaError is also thrown.

 

